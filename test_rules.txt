[Adblock Plus 3.1; uBlock; AdGuard]
[AdGuard; Invalid Name 2.0]
!
! Test rules for the syntax highlighter
!

# Some comments (should be all green)
!
#

!
! Pre-processor directives and hints
!
!#if (adguard && !adguard_ext_safari)
!#include https://example.org/
!#endif
!+ NOT_OPTIMIZED PLATFORM(android)
||example.org^
!#invalidpreprocessor
!#if (invalid_platform)
!#safari_cb_affinity(general,privacy)
!#safari_cb_affinity
!#safari_cb_affinity(invalid)

!
! Basic rules (valid)
!
example.org
@@||example.org^
||example.org^
|https://www.example.org/|
/banner
||example.org^$third-party
||example.org^$~object-subrequest

! Domain
||example.org$domain=~example.org|~test.org
*.domain.com$domain=example.org|test.org,third-party,subdocument
||example.org$domain=j.gs
||example.org$domain=google.*
*$3p,script,denyallow=hello.com|service.me,domain=example.*|test.org

! Domain invalid: https://github.com/ameshkov/VscodeAdblockSyntax/issues/26
||parajumpersnettbutikk.com^$document,domain=~ Advarselen vises grunnet: En grovt falsk nettbutikksvindel som er svartelistet av Forbrukertilsynet.

! No URL
$websocket,domain=example.org

! App
||testwinapp.org^$app=Skype.exe
||testapp.org^$app=com.adguard.android|~com.example
||testws.org^$websocket,xmlhttprequest
||testws.org^$~websocket,~xmlhttprequest

! -------------------------
! Modifiers
! -------------------------

! Csp
||example.org^$csp=frame-src 'none'
@@||example.org^$csp

! Badfilter
@@||example.org^$badfilter

! Redirect
||example.org^$redirect=google-analytics.com/ga.js
||example.org/$script,redirect-rule=noop.txt

! Rewrite
||example.org^$rewrite=abp-resource:blank-html

! Helper modifiers: #23
||example.org^$first-party
||example.org^$xhr
||example.org^$inline-script
||example.org^$inline-font
||example.org^$popunder

! extension modifier: #31
@@||taxes.hrblock.com^$extension

! more modifiers aliases: #34
||example.org^$all
||example.org^$3p
||example.org^$1p
||example.org^$css
||example.org^$frame
||example.org^$ghide
||example.org^$ehide
||example.org^$shide
||example.org^$specifichide

!
! Basic rules (invalid)
!
||example.org$domain=~example.org,~test.org
||example.org$domain=~example.org.~test.org
||testwinapp.org^$app=Skype.exe,~test.com
||testwinapp.org^$app=Skype.exe.~com.adguard

!
! Basic rules (regex)
!
/banner/
@@/banner\d+/$third-party

!
! Basic rules ($replace)
!
||example.org^$replace=/(<VAST[\s\S]*?>)[\s\S]*<\/VAST>\/\$1<\/VAST>/gi,third-party
||example.org^$important,replace=/(<VAST[\s\S]*?>)[\s\S]*<\/VAST>\/\$1<\/VAST>/gi,third-party
||example.net^$replace=/[\s\S]+//,important,domain=example.org|example.com
@@||example.org^$replace

!
! Elemhide rules (valid)
!
##.valid_selector
j.gs,46.166.167.16,example.org##banner
example.org##valid_selector
~example.org##valid_selector
example.org,~hello.com##valid_selector
example.org#@#valid_selector
example.org#@#valid_selector
example.org,example.com##valid_selector
example.org,example.com,test.com##valid_selector
business-service.me#@##banner_ad
q.gs#@##bottom
j.gs#@##bottom
berlin.de##.teaser[-ext-has='>.inner>h3>a.trakkking,>.inner>h3:not(:has(>))']
xn--fgelsng-exae.se##banner
xn--80aneaaefcxzcih6g1e.xn--p1ai##banner
! TLD
google.*###center_col > #main > .dfrd > .mnr-c > .c._oc._zs
google.*###center_col > #res > #topstuff + #search > div > #ires > #rso > #flun
##[a=bc d="ef"]
##[a b c]
##.\abc
! Pseudo class, pseudo element
##:empty
##div:empty
! Pseudo element
##div > :empty::before
! Handle string escapes
##[data-something="ab\"c"] + .abc
##[data-something="a b\"c"] + .abc
! Comma separated parameter
example.com##aside.widget > a:not([href*="example.net"], [href*="example.org"], [href*="example.eu"]) > img

!
! Elemhide rules (invalid)
!
##invalid_selector { invalid part of it }
example.org,example.com|test.com##valid_selector
пример.рф##banner
|example.org##banner
! Invalid selectors
##.ad > $$
##[aaa
##[data-something="ab\"c"] + ..abc
##[data-testé^="ads" style="asd"]

!
! ExtCss rules (valid)
!
example.org#?#banner
example.org,example.com#@?#banner
4pda.ru##body > * > * > div > * > :not(div) > :not(div) > :not(div) > div:has(> h2:contains(/[APprmoАрРо]{8}/))
4pda.ru#?#body > * > * > div > * > :not(div) > :not(div) > :not(div) > div:has(> h2:contains(/[APprmoАрРо]{8}/))
##:-abp-has(div:-abp-contains(ad):is(.ad, .ad-extra):xpath(//*[@class="test-xpath-class"])):has(ad):contains(ad):upward(div[id]):contains(/^ad$/):nth-ancestor(2):matches-css(padding:1px):matches-property("check.track"):matches-attr("/-unit/"="/click/"):upward(1):empty:first-child:if-not(a[href$="ad.php"]:min-text-length(2))
! Pseudo inside another pseudo
##div:-abp-has(> .anything:-abp-has(custom-element:-abp-has(a)):-abp-contains(advert))
! xpath
#?#:xpath(//div[contains(@style,"b") and contains(@style,"b")]/ancestor-or-self::div[@style][1])
#?#:xpath(//div[contains(@style,"b") and contains(@style,"b")]/ancestor-or-self::div[@style][1]) > .something:xpath(//div[contains(@style,"b") and contains(@style,"b")]/ancestor-or-self::div[@style][1]) > section > div
! xpath from uBO filters
foxnews.com##:xpath(//*[contains(text(),"blocking software")]/../../..)
digminecraft.com##:xpath(//*[contains(text(),"Advertisements")]):upward(1)
! Regex parameter
##div:contains(/^example$/i):upward(1)
! Handle ) in the regex
##div:contains(/^example\.(org|com)$/):has(a):upward(1)
##div.ad > section > .ad ~ #some-ad > a#id:-abp-has(ad-component > ad-wrapper:-abp-has(some-element):-abp-contains(hello))
##a:has(:not(.ad):not(.test))
example.com#?##block > li.some:has(> .another caption > p:matches-css-before(content: /^(Ad|Reklama)$/)):has(a)
##div[class*=" "]:has(>div[class]:first-child:empty+img[src*="advert"][alt]:empty)
##.some-ad:remove()

!
! ExtCss rules (invalid)
!
example.org#?#banner { invalid part of it }
example.org,example.com|test.com#@?#banner
|example.org#?#banner
! Unknown pseudo
##:-abp-has2(> h2)
! Redundant )
##:-abp-has(div))
! remove is limited to work properly only at the end of selector
##.some-ad:remove() + div

!
! CSS rules (valid)
!
example.org#$?#banner { display: none!important; }
example.org#@$?#banner { display: none!important; }
#$#valid_style { position: absolute!important; }
example.org#$#some_style { visibitility: hidden; }
example.org,example.com,test.com#@$#valid_selector { visibitility: hidden; }
aternos.org#$##detect { height: 1px!important; }
example.org#$#div:-abp-has(> ad.some-element:contains(ad)) { display: none !important; }
example.org#@$#div:-abp-has(> ad.some-element:contains(ad)) { display: none !important; }
example.org##div:-abp-has(> ad.some-element:contains(ad)):style(display: none !important;)
! Media queries (some idea took from https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Using_media_queries)
example.org#$#@media (min-width: 1200px and( min-width: 200px) { body { padding-top: 0!important; } }
example.org#$#@media (min-width: 30em) and (orientation: landscape) { body { padding-top: 0!important; } }
example.org#$#@media not screen and (color), print and (color) { body { padding-top: 0!important; } }
example.org#$#@media (min-height: 680px), screen and (orientation: portrait) { body { padding-top: 0!important; } }
! uBO :style()
example.org##body:style(padding-top: 0!important;)
example.org#@#body:style(padding-top: 0!important;)

!
! CSS rules (invalid)
!
#$#invalid_style
! Unknown marker, highlight ignored
example.org,example.com,test.com#$@#wrong_syntax { visibitility: hidden; }
|example.org#$#banner { }
! Invalid selector
example.org#$#div:-abp-has(> ad.séome-element:contains(ad)) { display: none !important; }
example.org#$#$$ { display: none !important; }
! Invalid CSS rules, property value highlight ignored
example.org#$#div:-abp-has(> ad.some-element:contains(ad)) { display: ignored !important; }
! Missing selector
example.org#$#@media (min-width: 1200px) { padding-top: 0!important; }
! uBO :style()
example.org##divééé:style(
! Invalid CSS rules, property value highlight ignored
example.org#@#div:style(ééé)
example.org##div:style(display: ignored !important;)

!
! Content-filtering rules (valid)
!
$$script[id="hello"]
example.org$$script[id="hello"][tag-content="hello"][max-length="hi"]
example.org,example.com$@$script[id="hello"][tag-content="something"]
example.org$$script

!
! Content-filtering rules (invalid)
!
exam$$script[id="hello"]
$$tag-name[id=value]
$$tag-name[id=value
$$div[id="value"]["val"="val"]

!
! JS rules rules (valid)
!
#%#window.adblock = 1;
example.org#@%#window.adblock = 1;
example.org,hello.com#%#window.adblock = 1;
nj.com#%#window.hello = 1;
southwalesargus.co.uk#%#window.hello = 1;

!
! Scriptlets (AdGuard)
!
example.org#%#//scriptlet('name')
example.org#%#//scriptlet('name', '')
example.org#%#//scriptlet('name', "")
example.org#%#//scriptlet('name', 'param')
example.org#%#//scriptlet("abort-on-property-read", "alert")
example.com#%#//scriptlet('abort-current-inline-script', 'document.addEventListener', '/example|test/')
example.com#%#//scriptlet("remove-class", 'branding', "div[class^=\"inner\"]")

!
! Scriptlets (uBO)
!
example.org##+js(goyavelab-defuser.js)
ze.tt##+js(addEventListener-defuser.js, /^(?:DOMContentLoaded|load)$/, =!0)
lablue.*##+js(setTimeout-defuser.js, r(), 500)
! Skipped arguments
example.com##+js(scriptlet, , arg2)
example.com##+js(scriptlet, , , arg3)
example.com##+js(scriptlet, arg1, , arg3)
! Exception
example.com#@#+js(scriptlet, arg1, , arg3)

!
! ABP snippets (valid)
!
reuters.com#$#abort-current-inline-script String.fromCharCode 69bfbfdbe821fab7200e9613cab94c8b
yandex.com#$#hide-if-contains ad li.serp-item 'li.serp-item div.label'
zhlednito.cz#$#abort-on-property-read Aloader; abort-on-property-read ExoLoader; abort-on-property-read ExoLoader.serve
facebook.com#$#hide-if-has-and-matches-style 'abbr .timestampContent' 'div[id^="hyperfeed_story_id_"]' 'div[id*="feed_subtitle_"] > span, div[id*="feed_subtitle_"] > s' '' 'display: none'; hide-if-contains /.*/ .ego_section 'a[href^="/ad__campaign/landing.php?"]'; hide-if-contains /.*/ .ego_section 'a[href^="/ad_campaign/landing.php?"]'; hide-if-contains /.*/ .ego_section 'a[href^="/ad___campaign/landing.php?"]'
! Multiple
example.com#$#snippet1 arg1 arg2; snippet2 arg1 arg2; snippet3 arg1;
! Contains {} - possible conflict with CSS injections
example.com#$#snippet1 /[Sponsred]{9}|[Gesponrtd]{10}/
! Spaces
example.com#$#snippet1;snippet2;snippet3;
example.com#$#snippet1 ; snippet2 ; snippet3;
example.com#$#snippet1  ;  snippet2  arg1     arg2  ;   snippet3 "arg1" 'arg2';

!
! ABP snippets (invalid)
!
example.com#$#$snippet1 arg1 arg2
example.com#$#snip@pet1 arg1 arg2
example.com#$#snippet1 arg1 arg2; &snippet2 arg1 arg2; snippet3 arg1;

!
! HTML filtering (uBO)
!
express.de,giga.de,kicker.de##^script:has-text((window);)
wetteronline.de##^script:has-text(runCount)
finanzen.*##^script:has-text(Inject=!)

!
! $cookie rules
!
$cookie=__cfduid
$cookie=test,domain=example.org
||example.org^$cookie
||facebook.com^$third-party,cookie=c_user
@@||example.org^$cookie=/regular_expression/
||example.org^$cookie=NAME;maxAge=3600;sameSite=lax
@@||example.org^$cookie

!
! $removeparam and $queryprune rules
!
||example.org^$removeparam
||example.org^$removeparam=test
||example.org^$removeparam=~test
||example.org^$removeparam=/^(test|test2)=/i
||example.org^$queryprune
||example.org^$queryprune=test
||example.org^$queryprune=~test
||example.org^$queryprune=/^(test|test2)=/i

!
! $removeheader rules
!
||destyy.com^$removeheader=request:user-agent
||utarget.ru/ranging/*/click/$removeheader=location
$removeheader=location,domain=zannn.top|innal.top
/games-pc.top\/forum\/(?!login.php)/$removeheader=location

!
! $stealth rules
!
@@||example.org^$stealth
@@||example.org^$stealth,domain=example.org

!
! DNS filtering modifiers
!
! $client
@@||*^$client=127.0.0.1
||example.org^$client=192.168.0.0/24
||example.org^$client=~'Mary\'s\, John\'s\, and Boris\'s laptops',denyallow=example.org
||example.org^$client=~Mom|~Dad|Kids
! $ctag
||example.org^$ctag=device_pc|device_phone
||example.org^$ctag=~device_phone
! $dnstype
||example.org^$dnstype=AAAA
||example.org^$dnstype=~A|~CNAME
! $dnsrewrite
||example.com^$dnsrewrite=example.net
||example.com^$dnsrewrite=NOERROR;CNAME;example.net
||example.com^$dnsrewrite=NOERROR;A;1.2.3.4
||example.com^$dnsrewrite=NOERROR;SVCB;32 example.com alpn=h3
||example.com^$dnsrewrite=NXDOMAIN;;

!
! Cosmetic rules modifiers
!
[$path=/test]##banner
[$path=/test]#@#banner
[$path=/test]#?#.banner
[$path=/test]#@?#.banner
[$path=/test]#$#banner { style: display: none!important; }
[$path=/test]#@$#banner { style: display: none!important; }
[$path=/test,app=com.google.search]##banner
[$path=/test,domain=example.org]##banner
[$path=/test]$$banner
[$path=/test]example.org#%#//scriptlet('name', '')

!
! Cosmetic rules modifiers, invalid modifiers
!
[$randommodifier=test]##banner

! https://github.com/ameshkov/VscodeAdblockSyntax/issues/25
/^https:\/\/.*?\/v2\/0\/[a-zA-Z0-9_-]{30,}$/$third-party,script,$domain=~example.org
||example.com/example.js^$script,$third-party,$domain=example.org
||example.com/example.js^$script,$~third-party,$domain=example.org
||example.com/example.js^$script,third-party,$domain=example.org|example.net
