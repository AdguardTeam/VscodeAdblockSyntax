{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "Adblock",
	"patterns": [
		{
			"include": "#comments"
		},
		{
			"include": "#cssRules"
		},
		{
			"include": "#jsRules"
		},
		{
			"include": "#contentRules"
		},
		{
			"include": "#elemhideRules"
		},		
		{
			"include": "#basicRulesNoUrl"
		},		
		{
			"include": "#basicRules"
		}
	],
	"repository": {
		"comments": {
			"patterns": [
				{
					"name": "comment.line",
					"match": "^!.*"
				},
				{
					"name": "comment.line.header",
					"match": "^\\[Adblock.*"
				},
				{
					"name": "comment.line.batch-style",
					"match": "^# .*"
				}
			]
		},
		"elemhideRules": {
			"patterns": [
				{
					"match": "^(.*?)(#@?\\??#)(.+)$",
					"captures": {
						"1": {
							"patterns": [
								{
									"include": "#domainListCommaSeparated"
								}
							]
						},
						"2": {
							"name": "keyword.control.adblock"
						},
						"3": {
							"patterns": [
								{
									"include": "#cssSelector"
								}
							]
						}
					}
				}
			]
		},
		"cssRules": {
			"patterns": [
				{
					"match": "^(.*?)(#@?\\??\\$#)(.+)$",
					"captures": {
						"1": {
							"patterns": [
								{
									"include": "#domainListCommaSeparated"
								}
							]
						},
						"2": {
							"name": "keyword.control.adblock"
						},
						"3": {
							"patterns": [
								{
									"include": "#cssStyle"
								}
							]
						}
					}
				}
			]
		},
		"contentRules": {
			"patterns": [
				{
					"match": "^(.*?)(\\$@?\\$)(.+?)(\\[.+)$",
					"captures": {
						"1": {
							"patterns": [
								{
									"include": "#domainListCommaSeparated"
								}
							]
						},
						"2": {
							"name": "keyword.control.adblock"
						},
						"3": {
							"name": "entity.name.function.adblock"
						},
						"4": {
							"patterns": [
								{
									"include": "#contentAttributes"
								}
							]
						}
					}
				}
			]
		},
		"jsRules": {
			"patterns": [
				{
					"match": "^(.*?)(#@?%#)(.+)$",
					"captures": {
						"1": {
							"patterns": [
								{
									"include": "#domainListCommaSeparated"
								}
							]
						},
						"2": {
							"name": "keyword.control.adblock"
						},
						"3": {
							"patterns": [
								{
									"include": "#jsFunction"
								}
							]
						}
					}
				}
			]
		},
		"basicRulesNoUrl": {
			"patterns": [
				{
					"match": "^(\\$)(.+)$",
					"captures": {
						"1": {
							"name": "keyword.control.adblock"
						},
						"2": {
							"patterns": [
								{
									"include": "#basicRulesOptions"
								}
							]
						}
					}
				}
			]
		},
		"basicRules": {
			"patterns": [
				{
					"match": "^(.+?)((\\$)(.*))?$",
					"captures": {
						"1": {
							"patterns": [
								{
									"include": "#urlPattern"
								}
							]
						},
						"3": {
							"name": "keyword.control.adblock"
						},
						"4": {
							"patterns": [
								{
									"include": "#basicRulesOptions"
								}
							]
						}
					}
				}
			]
		},
		"urlPattern": {
			"patterns": [
				{
					"name": "string.regexp.adblock",
					"match": "^(@@)?(\\/)(.+)\\/$",
					"captures": {
						"1": {
							"name": "keyword.other.adblock"
						}
					}
				},
				{
					"match": "^@@\\|?\\|?",
					"name": "keyword.other.adblock"
				},
				{
					"match": "^\\|\\|",
					"name": "keyword.other.adblock"
				},
				{
					"match": "^\\|",
					"name": "keyword.other.adblock"
				},
				{
					"match": "\\|$",
					"name": "keyword.other.adblock"
				},
				{
					"match": "\\^",
					"name": "keyword.other.adblock"
				},
				{
					"match": "\\*",
					"name": "keyword.other.adblock"
				}
			]
		},
		"basicRulesOptions": {
			"patterns": [
				{
					"match": "replace=((\\/)(((\\\\\\/)|[^,\/]|(\\\\,))+?)(\\/)(((\\\\\\/)|[^,\/]|(\\\\,))*?)(\\/)([a-z]*))",
					"name": "keyword.other.adblock",
					"captures": {
						"1": {
							"name": "string.regexp.adblock"
						}
					}
				},				
				{
					"match": "(domain)(=)([^,]+)",
					"captures": {
						"1": {
							"name": "keyword.other.adblock"
						},
						"2": {
							"name": "keyword.operator.adblock"
						},
						"3": {
							"patterns": [
								{
									"include": "#domainListPipeSeparated"
								}
							]
						}						
					}
				},
				{
					"match": "(app)(=)([^,]+)",
					"captures": {
						"1": {
							"name": "keyword.other.adblock"
						},
						"2": {
							"name": "keyword.operator.adblock"
						},
						"3": {
							"patterns": [
								{
									"include": "#appListPipeSeparated"
								}
							]
						}
					}
				},
				{
					"match": "(csp)(=)([^,]+)",
					"name": "keyword.other.adblock",
					"captures": {
						"1": {
							"name": "keyword.other.adblock"
						},
						"2": {
							"name": "keyword.operator.adblock"
						},
						"3": {
							"name": "string.unquoted.adblock"
						}					
					}
				},
				{
					"match": "(~?)(mp4|empty|badfilter|genericblock|generichide|third-party|network|match-case|popup|elemhide|content|jsinject|urlblock|document|image|stylesheet|script|object-subrequest|object|font|media|subdocument|xmlhttprequest|websocket|other|important|webrtc)",
					"name": "keyword.other.adblock"
				},
				{
					"match": ",",
					"name": "punctuation.definition.adblock"
				}
			]
		},
		"contentAttributes": {
			"patterns": [
				{
					"match": "(\\[)([^\"=]+?)(\\=)(\".+?\")(\\])",
					"captures": {
						"1": {
							"name": "punctuation.section.adblock"
						},
						"2": {
							"name": "keyword.other.adblock"
						},
						"3": {
							"name": "keyword.operator.adblock"
						},
						"4": {
							"name": "string.quoted.adblock"
						},
						"5": {
							"name": "punctuation.section.adblock"
						}
					}
				},
				{
					"name": "invalid.illegal.adblock",
					"match": ".*"
				}
			]
		},
		"jsFunction": {
			"patterns": [
				{
					"name": "constant.character.jscode.adblock",
					"match": ".+"
				}
			]
		},
		"cssStyle": {
			"patterns": [
				{
					"match": "([^{}]+)\\s*((\\{)(.+?)(\\}))",
					"captures": {
						"1": {
							"name": "entity.name.function.adblock"
						},
						"3": {
							"name": "punctuation.section.adblock"
						},
						"4": {
							"name": "string.quoted.adblock"
						},
						"5": {
							"name": "punctuation.section.adblock"
						}
					}
				},
				{
					"name": "invalid.illegal.adblock",
					"match": ".*"
				}
			]
		},
		"cssSelector": {
			"patterns": [
				{
					"name": "entity.name.function.adblock",
					"match": "[^{}]+"
				},
				{
					"name": "invalid.illegal.adblock",
					"match": ".*"
				}
			]
		},
		"domainListCommaSeparated": {
			"patterns": [
				{
					"match": "((~?)(([a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]?\\.?)+\\.[a-zA-Z0-9-]{2,})(,?))",
					"captures": {
						"2": {
							"name": "keyword.other.adblock"
						},
						"3": {
							"name": "string.unquoted.adblock"
						},
						"5": {
							"name": "punctuation.definition.adblock"
						}
					}
				},
				{
					"match": "((~?)(([0-9]{1,3}\\.?){4})(,?))",
					"captures": {
						"2": {
							"name": "keyword.other.adblock"
						},
						"3": {
							"name": "string.unquoted.adblock"
						},
						"5": {
							"name": "punctuation.definition.adblock"
						}
					}
				},
				{
					"name": "invalid.illegal.domain-list",
					"match": ".*"
				}
			]
		},
		"domainListPipeSeparated": {
			"patterns": [
				{
					"match": "((~?)(([a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]?\\.?)+\\.[a-zA-Z0-9-]{2,})(\\|?))",
					"captures": {
						"2": {
							"name": "keyword.other.adblock"
						},
						"3": {
							"name": "string.unquoted.adblock"
						},
						"5": {
							"name": "punctuation.definition.adblock"
						}
					}
				},
				{
					"match": "((~?)(([0-9]{1,3}\\.?){4})(\\|?))",
					"captures": {
						"2": {
							"name": "keyword.other.adblock"
						},
						"3": {
							"name": "string.unquoted.adblock"
						},
						"5": {
							"name": "punctuation.definition.adblock"
						}
					}
				},
				{
					"name": "invalid.illegal.domain-list",
					"match": ".*"
				}
			]
		},
		"appListPipeSeparated": {
			"patterns": [
				{
					"match": "((~?)([a-zA-Z0-9.-_]+)(\\|?))",
					"captures": {
						"2": {
							"name": "keyword.other.adblock"
						},
						"3": {
							"name": "string.unquoted.adblock"
						},
						"4": {
							"name": "punctuation.definition.adblock"
						}
					}
				},
				{
					"name": "invalid.illegal.app-list",
					"match": ".*"
				}
			]
		}		
	},
	"scopeName": "text.adblock"
}